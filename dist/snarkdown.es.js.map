{"version":3,"file":"snarkdown.es.js","sources":["../src/index.js"],"sourcesContent":["(function(root, factory) {\n\tif (typeof define==='function' && define.amd) {\n\t\tdefine([], factory);\n\t}\n\telse if (typeof exports==='object') {\n\t\tmodule.exports = factory();\n\t}\n\telse {\n\t\troot.snarkdown = factory();\n\t}\n}(this, function() {\n\tvar tags = {\n\t\t\t_ : ['<em>','</em>'],\n\t\t\t__ : ['<strong>','</strong>'],\n\t\t\t'\\n\\n' : ['<br />\\n\\n', false],\n\t\t\t'>' : ['<blockquote>','</blockquote>'],\n\t\t\t'*' : ['<ul>','</ul>'],\n\t\t\t'#' : ['<ol>','</ol>']\n\t\t},\n\t\tescaped = /[^\\\\](\\\\\\\\)*\\\\$/g;\n\n\tfunction tag(context, token) {\n\t\tvar norm = token.replace(/\\*/g,'_').replace(/^(  \\n\\n*|\\n{2,})/g,'\\n\\n'),\n\t\t\tend = context[context.length-1]===token,\n\t\t\tdesc = tags[norm];\n\t\tif (!desc) return token;\n\t\tif (desc[1]===false) return desc[0];\n\t\tcontext[end?'pop':'push'](token);\n\t\treturn desc[ end ? 1 : 0 ];\n\t}\n\n\tfunction outdent(str, ch) {\n\t\tch = (ch || '') + (str.match(/^(\\t|  )+/m) || ['[\\\\t ]*'])[0];\n\t\treturn str.replace(new RegExp('^'+ch,'gm'),'');\n\t}\n\n\tfunction trim(str) {\n\t\treturn str.replace(/(^\\n+|\\n+$)/g,'');\n\t}\n\n\tfunction parse(md) {\n\t\tvar tokenizer = /(?:^```(\\w*)\\n([\\s\\S]*?)\\n```$)|((?:(?:^|\\n+)(?:\\t|  {2,}).+)+\\n*)|((?:(?:^|\\n)([>*+-]|\\d+\\.)\\s+.*)+)|(?:\\[([^\\]]+?)\\]\\(([^\\)]+?)\\)|(?:(?:^|\\n+)([^\\s].*)\\n(\\-{3,}|={3,})(?:\\n+|$))|(?:(?:^|\\n+)(#{1,3})\\s*(.+)(?:\\n+|$))|(?:`([^`].*?)`)|(  \\n\\n*|\\n{2,}|__|\\*\\*|[_*]))/gm,\n\t\t\tcontext = [],\n\t\t\tout = '',\n\t\t\tlast = 0,\n\t\t\tchunk, prev, token, esc, reg, inner, t, i;\n\t\tmd = trim(md);\n\n\t\ttokenizer.lastIndex = 0;\n\t\twhile ( (token=tokenizer.exec(md)) ) {\n\t\t\tprev = md.substring(last, token.index);\n\t\t\tlast = tokenizer.lastIndex;\n\t\t\tchunk = token[0];\n\t\t\tescaped.lastIndex = 0;\n\t\t\tif (escaped.test(prev)) {\n\t\t\t\t// escaped\n\t\t\t}\n\t\t\t// Code blocks:\n\t\t\telse if (token[2]) {\n\t\t\t\tchunk = '\\n<pre class=\"code '+String(token[1]).toLowerCase()+'\">'+token[2]+'</pre>\\n';\n\t\t\t}\n\t\t\t// Indent blocks:\n\t\t\telse if (token[3]) {\n\t\t\t\tchunk = '\\n<pre class=\"code poetry\">'+trim(outdent(token[3]))+'</pre>\\n';\n\t\t\t}\n\t\t\t// > Quotes, -* lists:\n\t\t\telse if (token[5]) {\n\t\t\t\tt = token[5];\n\t\t\t\tif (t.charAt(t.length-1)==='.') {\n\t\t\t\t\tt = '.';\n\t\t\t\t\ttoken[4] = token[4].replace(/^\\d+/gm, '');\n\t\t\t\t}\n\t\t\t\tinner = parse(outdent(token[4], '[>*+-.]'));\n\t\t\t\tif (t!=='>') {\n\t\t\t\t\tt = t==='.' ? '#' : '*';\n\t\t\t\t\tinner = inner.replace(/^(.*)$/gm, '\\t<li>$1</li>');\n\t\t\t\t}\n\t\t\t\tchunk = '\\n'+tags[t][0]+'\\n' + inner + '\\n'+tags[t][1]+'\\n';\n\t\t\t}\n\t\t\t// Links:\n\t\t\telse if (token[6]) {\n\t\t\t\tchunk = token[6].link(token[7].replace(/^javascript\\:/g,''));\n\t\t\t}\n\t\t\t// Titles:\n\t\t\telse if (token[8] || token[10]) {\n\t\t\t\tt = 'h' + (token[10] ? token[10].length : (token[9][0]==='='?1:2));\n\t\t\t\tchunk = '\\n\\n<'+t+'>' + parse(token[8] || token[11]) + '</'+t+'>\\n';\n\t\t\t}\n\t\t\t// `code`:\n\t\t\telse if (token[12]) {\n\t\t\t\tchunk = '<code>'+token[12]+'</code>';\n\t\t\t}\n\t\t\t// Inline formatting: *em*, **strong** & friends\n\t\t\telse if (token[13]) {\n\t\t\t\tchunk = tag(context, token[13]);\n\t\t\t}\n\t\t\tout += prev;\n\t\t\tout += chunk;\n\t\t}\n\n\t\tout += md.substring(last);\n\t\tfor (i=context.length; i--; ) {\n\t\t\tout += tag(context, context[i]);\n\t\t}\n\n\t\treturn trim(out);\n\t}\n\n\tparse.parse = parse;\n\treturn parse;\n}));\n"],"names":["this"],"mappings":"AAAA,CAAC,SAAS,IAAI,EAAE,OAAO,EAAE;CACxB,IAAI,OAAO,MAAM,GAAG,UAAU,IAAI,MAAM,CAAC,GAAG,EAAE;EAC7C,MAAM,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;EACpB;MACI,IAAI,OAAO,OAAO,GAAG,QAAQ,EAAE;EACnC,MAAM,CAAC,OAAO,GAAG,OAAO,EAAE,CAAC;EAC3B;MACI;EACJ,IAAI,CAAC,SAAS,GAAG,OAAO,EAAE,CAAC;EAC3B;CACD,CAACA,SAAI,EAAE,WAAW;CAClB,IAAI,IAAI,GAAG;GACT,CAAC,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC;GACpB,EAAE,GAAG,CAAC,UAAU,CAAC,WAAW,CAAC;GAC7B,MAAM,GAAG,CAAC,YAAY,EAAE,KAAK,CAAC;GAC9B,GAAG,GAAG,CAAC,cAAc,CAAC,eAAe,CAAC;GACtC,GAAG,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC;GACtB,GAAG,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC;GACtB;EACD,OAAO,GAAG,kBAAkB,CAAC;;CAE9B,SAAS,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE;EAC5B,IAAI,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,oBAAoB,CAAC,MAAM,CAAC;GACvE,GAAG,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,KAAK;GACvC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;EACnB,IAAI,CAAC,IAAI,EAAE,EAAA,OAAO,KAAK,CAAC,EAAA;EACxB,IAAI,IAAI,CAAC,CAAC,CAAC,GAAG,KAAK,EAAE,EAAA,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC,EAAA;EACpC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC;EACjC,OAAO,IAAI,EAAE,GAAG,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC;EAC3B;;CAED,SAAS,OAAO,CAAC,GAAG,EAAE,EAAE,EAAE;EACzB,EAAE,GAAG,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;EAC9D,OAAO,GAAG,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;EAC/C;;CAED,SAAS,IAAI,CAAC,GAAG,EAAE;EAClB,OAAO,GAAG,CAAC,OAAO,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;EACtC;;CAED,SAAS,KAAK,CAAC,EAAE,EAAE;EAClB,IAAI,SAAS,GAAG,4QAA4Q;GAC3R,OAAO,GAAG,EAAE;GACZ,GAAG,GAAG,EAAE;GACR,IAAI,GAAG,CAAC;GACR,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3C,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;;EAEd,SAAS,CAAC,SAAS,GAAG,CAAC,CAAC;EACxB,SAAS,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI;GACpC,IAAI,GAAG,EAAE,CAAC,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;GACvC,IAAI,GAAG,SAAS,CAAC,SAAS,CAAC;GAC3B,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;GACjB,OAAO,CAAC,SAAS,GAAG,CAAC,CAAC;GACtB,IAAI,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;;IAEvB;;QAEI,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE;IAClB,KAAK,GAAG,qBAAqB,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC;IACtF;;QAEI,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE;IAClB,KAAK,GAAG,6BAA6B,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC;IACzE;;QAEI,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE;IAClB,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IACb,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,GAAG,EAAE;KAC/B,CAAC,GAAG,GAAG,CAAC;KACR,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;KAC1C;IACD,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC;IAC5C,IAAI,CAAC,GAAG,GAAG,EAAE;KACZ,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;KACxB,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,UAAU,EAAE,eAAe,CAAC,CAAC;KACnD;IACD,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;IAC5D;;QAEI,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE;IAClB,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC,CAAC;IAC7D;;QAEI,IAAI,KAAK,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,EAAE,CAAC,EAAE;IAC/B,CAAC,GAAG,GAAG,IAAI,KAAK,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,MAAM,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACnE,KAAK,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;IACpE;;QAEI,IAAI,KAAK,CAAC,EAAE,CAAC,EAAE;IACnB,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC;IACrC;;QAEI,IAAI,KAAK,CAAC,EAAE,CAAC,EAAE;IACnB,KAAK,GAAG,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;IAChC;GACD,GAAG,IAAI,IAAI,CAAC;GACZ,GAAG,IAAI,KAAK,CAAC;GACb;;EAED,GAAG,IAAI,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;EAC1B,KAAK,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,IAAI;GAC7B,GAAG,IAAI,GAAG,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;GAChC;;EAED,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC;EACjB;;CAED,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;CACpB,OAAO,KAAK,CAAC;CACb,CAAC,EAAE"}